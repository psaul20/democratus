// Generated by ChatGPT
import 'dart:io';

void main() {
  final server = HttpServer.listen('localhost', 8080);
  print('Mock GPT API is running on http://localhost:8080');

  server.onRequest((request) {
    handleRequest(request);
  });
}

void handleRequest(HttpRequest request) async {
  if (request.method == 'POST' && request.uri.path == '/gpt') {
    final requestBody = await request.transform(utf8.decoder).join();
    final responseData = processGptRequest(requestBody);
    sendResponse(request, HttpStatus.ok, responseData);
  } else {
    sendResponse(request, HttpStatus.notFound, 'Not Found');
  }
}

String processGptRequest(String requestBody) {
  // Process the GPT request here and return the response data
  // You can simulate the behavior of a real GPT API service
  // For example, generating a text based on the input

  // Mock response for demonstration
  final response = {
    'generated_text': 'This is a generated response from the mock GPT API.'
  };
  return json.encode(response);
}

void sendResponse(HttpRequest request, int statusCode, String responseBody) {
  request.response
    ..statusCode = statusCode
    ..headers.contentType = ContentType.json
    ..write(responseBody)
    ..close();
}
